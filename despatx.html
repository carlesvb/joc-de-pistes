<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Despatx</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>

  <img src="img/icona-despatx.png" alt="Icona del Despatx" class="icona">

  <h1>üß© Despatx</h1>
  <p>Munteu el puzzle i desxifreu el missatge. PISTA: N√∫mero.</p>

  <input type="text" id="codiInput" placeholder="Introdueix la resposta aqu√≠">
  <button onclick="comprovarCodi()">Verificar</button>

  <div id="missatge"></div>

  <audio id="soExit">
    <source src="audio/success.mp3" type="audio/mpeg">
  </audio>
  <audio id="musicaFons" loop>
    <source src="audio/music.mp3" type="audio/mpeg">
  </audio>

  <button id="toggleMusic" onclick="alternarMusica()">üîá Silenciar m√∫sica</button>

  <div id="puzzlePieceContainer">
    <h2>üîç Pe√ßa de Puzzle</h2>
    <img src="img/puzzle-despatx.png" alt="Pe√ßa de puzzle - Despatx" class="puzzle-piece">
    <p>Potser aquesta pe√ßa t√© relaci√≥ amb la clau final...</p>
  </div>

  <script>
    document.body.style.backgroundImage = "url('img/background-despatx.jpg')";

    window.addEventListener("load", () => {
      const musica = document.getElementById("musicaFons");
      musica.play().catch(() => {});
    });

    function normalitzarCodi(codi) {
      return codi.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toUpperCase();
    }

    function comprovarCodi() {
      const codiCorrecte = String.fromCharCode(53);
      const codiIntroduit = normalitzarCodi(document.getElementById("codiInput").value.trim());
      const missatgeDiv = document.getElementById("missatge");
      const so = document.getElementById("soExit");

      if (codiIntroduit === codiCorrecte) {
        missatgeDiv.textContent = "‚úÖ Correcte! Has descobert:";
        missatgeDiv.className = "correcte";
        const info = document.createElement("p");
        info.innerHTML = "<strong>Aqu√≠ hi ha germans que no comparteixen sang suposo que ja ho sabeu no?</strong>";
        missatgeDiv.appendChild(info);
        so.play();
      } else {
        missatgeDiv.textContent = "‚ùå Codi incorrecte. Torna-ho a provar.";
        missatgeDiv.className = "incorrecte";
      }
    }

    function alternarMusica() {
      const musica = document.getElementById("musicaFons");
      const boto = document.getElementById("toggleMusic");
      if (musica.paused) {
        musica.play();
        boto.textContent = "üîá Silenciar m√∫sica";
      } else {
        musica.pause();
        boto.textContent = "üîä Activar m√∫sica";
      }
    }
  </script>

</body>
</html>
